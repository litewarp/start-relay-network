# Shared tasks for all Node.js projects
fileGroups:
  sources:
    - "src/**/*"
  tests:
    - "**/__tests__/**/*"
    - "**/*.test.*"
    - "**/*.spec.*"
  configs:
    - "*.config.*"

tasks:
  lint:
    command: "bunx oxlint ."
    inputs:
      - "@globs(sources)"
      - "@globs(tests)"
      - "@globs(configs)"

  lint-fix:
    command: "bunx oxlint --fix ."
    inputs:
      - "@globs(sources)"
      - "@globs(tests)"
      - "@globs(configs)"

  format:
    command: "bunx oxfmt ."
    inputs:
      - "@globs(sources)"
      - "@globs(tests)"
      - "@globs(configs)"

  format-write:
    command: "bunx oxfmt --write ."
    inputs:
      - "@globs(sources)"
      - "@globs(tests)"
      - "@globs(configs)"

  typecheck:
    command: "bunx tsc --noEmit"
    inputs:
      - "@globs(sources)"
      - "@globs(tests)"
      - "tsconfig.json"

  test:
    command: "bunx vitest run"
    inputs:
      - "@globs(sources)"
      - "@globs(tests)"

  test-watch:
    command: "bunx vitest"
    options:
      cache: false
      persistent: true

  test-coverage:
    command: "bunx vitest run --coverage"
    inputs:
      - "@globs(sources)"
      - "@globs(tests)"
